<div class="bot-panel" tabindex="0">
  <div class="row-action-primary">
    <i>{{bot.t}}</i>
  </div>
  <div class="row-content bot-panel-small">
    <h4>
      <span ng-switch="showControls">
        <span ng-switch-when="true">
          <a href editable-text="bot.name" onbeforesave="checkName($data)">{{ bot.name }}</a>
        </span>
        <span ng-switch-default>{{ bot.name }}</span>
      </span>
      <span class="badge alert-danger" ng-show="bot.message.length"  ng-click="main.bot = bot; showControls = true; logActive = true;">!</span>
    </h4>

    <div class="row">
      <!-- label class="col-sm-2">MC</label-->
      <div class="col-sm-3">-{{bot.moveCost() | number : 0}} [J/km]</div>
      <!-- label class="col-sm-2">Ch</label -->
      <div class="col-sm-3">+{{bot.chargeRate() | number : 2}} [J/d]</div>
    </div>

    <div class="row">
      <!-- label class="col-sm-2">[J]</label -->
      <div class="col-xs-6">
        <progressbar class="active" ng-attr-animate="false" ng-class="{'progress-striped': bot.E < bot.mE}" value="bot.E * 100 / bot.mE" type="danger">
          <span style="color:black; white-space:nowrap;">{{bot.E | number : 1}} / {{bot.mE | number : 0}} [J]</span>
        </progressbar>
      </div>

      <!-- label class="col-sm-2">Storage</label -->
      <div class="col-xs-6">
        <progressbar class="active" ng-attr-animate="false" value="bot.S * 100 / bot.mS" type="info">
          <span style="color:black; white-space:nowrap;">{{bot.S}} / {{bot.mS}} [kg]</span>
        </progressbar>
      </div>
    </div>
    <p />
    <div class="row">
      <div class="col-xs-6">

        <div class="row col-xs-10">
          <div class="input-group">
            <select class="form-control input-sm"
              ng-options="script.name as script.name for script in main.game.scripts"
              ng-model="bot.scriptName"
              ng-change="bot.setCode(bot.scriptName)">
              <option value="">Manual</option>
            </select>
            <span class="input-group-btn">
              <button class="btn btn-link btn-xxs"
                ng-click="main.showScripts(bot.scriptName)">
                <i class="glyphicon glyphicon-edit"></i>
              </button>
            </span>
          </div>
        </div>

        <!-- div class="btn-xs col-xs-6">
          <select class="form-control input-sm"
            ng-options="script.name as script.name for script in main.game.scripts"
            ng-model="bot.scriptName">
            <option value="">Manual</option>
          </select>
        </div>

        <button class="btn btn-xs col-xs-1"
          ng-click="main.showScripts(bot.scriptName)">
          <i class="glyphicon glyphicon-edit"></i>
        </button -->

        <button class="btn btn-danger btn-xs" tooltip="Launch"
          ng-click="main.relocate(bot); $event.stopPropagation();"
          ng-show="bot.canRelocate()">
          <i class="fa fa-rocket"></i>
          <span class="badge">-500 J</span>
        </button>


        <!-- div class="btn-group">
          <button type="button" class="btn btn-xs btn-primary dropdown-toggle" data-toggle="dropdown" aria-expanded="false">
            {{bot.scriptName || 'Manual' }}
            <span class="caret"></span>
            <span class="sr-only">Toggle Dropdown</span>
          </button>
          <ul class="dropdown-menu" role="menu">
            <li>
              <a href
                ng-click="bot.setCode(null)"
                ng-class="{ true: 'active' }[null === bot.scriptName]">
                <i class="" ng-class="{ true: 'mdi-toggle-radio-button-on', false: 'mdi-toggle-radio-button-off'}[bot.scriptName === null]"></i>
                Manual
              </a>
            </li>
            <li>
              <a href
                ng-click="bot.setCode(script)"
                ng-repeat="script in main.game.scripts"
                ng-class="{ true: 'active' }[script.name === bot.scriptName]">
                <i class="" ng-class="{ true: 'mdi-toggle-radio-button-on', false: 'mdi-toggle-radio-button-off'}[bot.scriptName === script.name]"></i>
                {{script.name}}
              </a>
            </li>
            <li class="divider"></li>
            <li ng-if="bot.scriptName"><a href ng-click="main.showScripts(bot.scriptName)">Edit</a></li>
          </ul>
        </div -->
      </div>
      <div class="col-xs-6">
        <button class="btn btn-info btn-xs" tooltip="Upgrade bot"
          ng-click="bot.upgrade(); $event.stopPropagation();"
          ng-disabled="bot.S < 10">
          <i class="fa fa-level-up"></i>
          <span class="badge">-10 kg</span>
        </button>
        <button class="btn btn-info btn-xs" tooltip="Construct new bot"
          ng-click="bot.construct(); $event.stopPropagation();"
          ng-if="bot.mS >= 100"
          ng-disabled="bot.S < 100">
          <i class="fa fa-user-plus"></i>
          <span class="badge">-100 kg</span>
        </button>

      </div>
    </div>

  </div>

  <div ng-if="showControls">
    <hr class="clearfix">
    <tabset type="pills" justified="true">
      <tab heading="Manual Control">
        <div class="row">
          <div class="col-lg-6 text-center">
            <u>Movement</u><br />
            <button class="btn btn-primary btn-mono btn-lg" ng-click="bot.move(-1,-1)" ng-disabled="!bot.canMove(-1,-1)">Q</button>
            <button class="btn btn-primary btn-mono btn-lg" ng-click="bot.move( 0,-1)" ng-disabled="!bot.canMove( 0,-1)">W</button>
            <button class="btn btn-primary btn-mono btn-lg" ng-click="bot.move( 1,-1)" ng-disabled="!bot.canMove( 1,-1)">E</button>
            <p />
            <button class="btn btn-primary btn-mono btn-lg" ng-click="bot.move(-1,0)" ng-disabled="!bot.canMove(-1,0)">A</button>
            <button class="btn btn-primary btn-mono btn-lg" ng-click="main.action(bot)" ng-disabled="!main.canAction(bot)">S</button>
            <button class="btn btn-primary btn-mono btn-lg" ng-click="bot.move( 1,0)" ng-disabled="!bot.canMove( 1,0)">D</button>
            <p />
            <button class="btn btn-primary btn-mono btn-lg" ng-click="bot.move(-1,1)" ng-disabled="!bot.canMove(-1,1)">Z</button>
            <button class="btn btn-primary btn-mono btn-lg" ng-click="bot.move( 0,1)" ng-disabled="!bot.canMove( 0,1)">X</button>
            <button class="btn btn-primary btn-mono btn-lg" ng-click="bot.move( 1,1)" ng-disabled="!bot.canMove( 1,1)">C</button>
            <p />
          </div>
          <div class="col-lg-6 script-btns">

            <u class="col-xs-11 text-center">Script</u>

            <div class="row script-btn" ng-repeat="script in main.game.scripts">
              <button class="btn btn-primary col-xs-11"
                ng-click="main.run(script.code)">
                {{script.name | limitTo : 10}}
              </button>
              <button class="btn btn-sm btn-link btn-hover col-xs-1"
                ng-click="main.showScripts(script.name)">
                <i class="glyphicon glyphicon-edit"></i>
              </button>
            </div>

          </div>

        </div>
      </tab>
      <tab heading="Log" active="logActive">
        <alert ng-repeat="alert in bot.alerts" type="{{alert.type}}" close="bot.closeAlert($index)">{{alert.msg}}</alert>
      </tab>
      <tab heading="Cheats" ng-if="main.cheat">
        <div class="row">
          <div class="col-md-12">
            <button ng-click="main.game.world.scanRange(bot.x,bot.y,20)">Show map</button>
            <br />Energy: <input type="number" ng-model="bot.E"> / <input type="number" ng-model="bot.mE"> <a href ng-click="bot.E = bot.mE">fill</a>
            <br />Storage: <input type="number" ng-model="bot.S"> / <input type="number" ng-model="bot.mS"> <a href ng-click="bot.S = bot.mS">fill</a>
          </div>
        </div>
      </tab>
    </tabset>

    <form class="console col-md-12" ng-submit="main.run(code); code = '';">
      <span class="glyphicon glyphicon-chevron-right search-icon pull-left"></span>
      <input class="form-control" type="text" ng-model="code">
    </form>

  </div>




</div>
